%%

%作者已经将所有相关图片制作了对应的代码块吗，逐个运行即可完成复现
%Matlab 2019b
%by 张广欣
%2022.3.13


%%
%预实验：甘油中的4mm铝珠
average_vel=[0.0078, 0.0082, 0.0078, 0.011, 0.01, 0.0095, 0.011, 0.011, 0.012, 0.0091];
log_vel = log(average_vel);
variance1 = var(log_vel)


%预实验：甘油中的6mm铝珠
average_vel=[0.017, 0.017, 0.018, 0.017, 0.017, 0.018, 0.017, 0.018, 0.018, 0.018];
log_vel = log(average_vel);
variance2 = var(log_vel)



%预实验：甘油中的8mm铝珠
average_vel=[0.026, 0.021, 0.019, 0.02, 0.021, 0.022, 0.018, 0.02, 0.021, 0.02];
log_vel = log(average_vel);
variance3 = var(log_vel)


%预实验：甘油中的11.4mm铝珠
average_vel=[0.037, 0.033, 0.033, 0.031, 0.028, 0.03, 0.029, 0.036, 0.034, 0.033];
log_vel = log(average_vel);
variance4 = var(log_vel)


%铝球在甘油中(预实验)
v_lst = [0.013634536,0.029964357,0.044773051,0.1074831];
r_lst = [2,3,4,5.7];
r_lst = log(r_lst);
v_lst = log(v_lst);%y是终速

variance = [variance1 variance2 variance3 variance4];
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('铝球在甘油中(预实验)')
text(0.65,-2.5,'R-squared: 0.99')
mdl = fitlm(r_lst,v_lst)

v_lst = [0.013634536,0.029964357,0.044773051,0.1074831];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1260;
eta = 0.934;
Re = rho*d_lst.*v_lst/eta


%%
%预实验：甘油中的4mm钢珠
average_vel=[0.041, 0.045, 0.043, 0.042, 0.043, 0.042, 0.045, 0.038, 0.052, 0.044];
log_vel = log(average_vel);
variance1 = var(log_vel);


%预实验：甘油中的6mm钢0。
average_vel=[0.0938, 0.117, 0.11, 0.093, 0.126, 0.0952, 0.0923, 0.0945, 0.0755, 0.103];
log_vel = log(average_vel);
variance2 = var(log_vel)



%预实验：甘油中的8mm钢珠
average_vel=[0.1, 0.15, 0.14, 0.13, 0.12, 0.13, 0.12, 0.1, 0.094, 0.13];
log_vel = log(average_vel);
variance3 = var(log_vel)


%预实验：甘油中的11.4mm钢珠
average_vel=[0.21, 0.19, 0.24, 0.19, 0.21, 0.18, 0.21, 0.15, 0.17, 0.3];
log_vel = log(average_vel);
variance4 = var(log_vel)

v_lst = [0.06076868,0.171276262,0.261319632,0.673494632];
r_lst = [2,3,4,5.7];

variance = [variance1 variance2 variance3 variance4];
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('钢珠在甘油中(预实验)')
text(2.1,0.6,'R-squared: 0.947')
mdl = fitlm(r_lst,v_lst)


v_lst = [0.06076868,0.171276262,0.261319632,0.673494632];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1260;
eta = 0.934;
Re = rho*d_lst.*v_lst/eta








%%
%钢球在甘油中的平均速度4mm 
dis=[0.097620759, 0.099691392, 0.101405316, 0.102706076, 0.10448481, 0.10629443, 0.107733418, 0.109645063, 0.111388101, 0.113203544, 0.114753671, 0.116792658, 0.118248354, 0.119938481, 0.121243291, 0.123112658, 0.12478, 0.126490633, 0.127916709, 0.129560253, 0.131295443, 0.132951139, 0.134753165, 0.136176456, 0.137908861, 0.139513165, 0.141308861, 0.142812152, 0.144342278, 0.146076709, 0.147572405, 0.148849367, 0.150843544, 0.152357215, 0.153861772, 0.155908861, 0.157864051, 0.159029873, 0.160537975, 0.162055443, 0.163667595, 0.165185063, 0.16678, 0.168267595, 0.170110127, 0.171077722, 0.173215443, 0.174766329, 0.176214937, 0.178575443, 0.179153671, 0.180710127, 0.181944557, 0.183830886, 0.185256456, 0.18697519, 0.189074177, 0.190641519, 0.191877722, 0.193426835, 0.194962532, 0.196213671, 0.198171646, 0.199549873, 0.201313924, 0.202741013, 0.204656456, 0.206231139, 0.207571392, 0.209381013, 0.210268861];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101, 1.134467801, 1.167834501, 1.201201201, 1.234567901, 1.267934601, 1.301301301, 1.334668001, 1.368034701, 1.401401401, 1.434768101, 1.468134801, 1.501501502, 1.534868202, 1.568234902, 1.601601602, 1.634968302, 1.668335002, 1.701701702, 1.735068402, 1.768435102, 1.801801802, 1.835168502, 1.868535202, 1.901901902, 1.935268602, 1.968635302, 2.002002002, 2.035368702, 2.068735402, 2.102102102, 2.135468802, 2.168835502, 2.202202202, 2.235568902, 2.268935602, 2.302302302, 2.335669002, 2.369035702];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
Average_vel1 = mean(v_lst);

dis=[0.080325505, 0.081377525, 0.082929798, 0.084938131, 0.086569444, 0.087356566, 0.088503283, 0.090630556, 0.09295, 0.094399495, 0.096138384, 0.09757601, 0.098927778, 0.100823232, 0.102479798, 0.10399798, 0.105234343, 0.1069, 0.10880303, 0.110544949, 0.112187374, 0.113847475, 0.115420202, 0.11655, 0.117975253, 0.119763636, 0.121516414, 0.123152778, 0.124779798, 0.126317929, 0.128006818, 0.1298, 0.131307828, 0.132705556, 0.134419192, 0.13587399, 0.137413889, 0.138686869, 0.140378788, 0.14192702, 0.143237626, 0.144931818, 0.146230808, 0.148148232, 0.149678535, 0.151206313, 0.15282096, 0.154649747, 0.156007828, 0.157173232, 0.159182323, 0.160501263, 0.162241919, 0.163798232, 0.165282323, 0.166719697, 0.168306061, 0.169853788, 0.171589899, 0.17349596, 0.174985859, 0.176302778, 0.17774798, 0.179396212, 0.18099596, 0.182258586, 0.184181566, 0.185697222, 0.187262626, 0.188775253, 0.190407071, 0.19202298, 0.193275253, 0.194944444, 0.196168687];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101, 1.134467801, 1.167834501, 1.201201201, 1.234567901, 1.267934601, 1.301301301, 1.334668001, 1.368034701, 1.401401401, 1.434768101, 1.468134801, 1.501501502, 1.534868202, 1.568234902, 1.601601602, 1.634968302, 1.668335002, 1.701701702, 1.735068402, 1.768435102, 1.801801802, 1.835168502, 1.868535202, 1.901901902, 1.935268602, 1.968635302, 2.002002002, 2.035368702, 2.068735402, 2.102102102, 2.135468802, 2.168835502, 2.202202202, 2.235568902, 2.268935602, 2.302302302, 2.335669002, 2.369035702, 2.402402402, 2.435769102, 2.469135802, 2.502502503];

delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.069879545, 0.071725758, 0.073607323, 0.075406566, 0.077133586, 0.078463384, 0.079954798, 0.081809848, 0.084289899, 0.085307828, 0.086736364, 0.088645707, 0.090345707, 0.091859848, 0.093527778, 0.095207576, 0.096469949, 0.098021465, 0.099706818, 0.101748232, 0.103318434, 0.104763636, 0.106120707, 0.107696717, 0.109387374, 0.110552778, 0.112253283, 0.113587879, 0.115341667, 0.11754798, 0.118842424, 0.12037399, 0.122061111, 0.123839394, 0.124741919, 0.126530808, 0.128062626, 0.129567677, 0.131266162, 0.133211616, 0.134623232, 0.136025505, 0.137725253, 0.138661616, 0.140534848, 0.142240909, 0.143481818, 0.145083081, 0.146652273, 0.148389646, 0.149696717, 0.151335606, 0.152474242, 0.153838384, 0.155362879, 0.156619444, 0.158194697, 0.159441162, 0.161668939, 0.163014394, 0.164208838, 0.165367424, 0.167107323, 0.168447222, 0.169888889, 0.171402525, 0.172766919, 0.173889899, 0.175499495, 0.177086364, 0.178352778, 0.179888384, 0.181407576, 0.182865152, 0.184098485, 0.185636869, 0.186835859, 0.187249495];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101, 1.134467801, 1.167834501, 1.201201201, 1.234567901, 1.267934601, 1.301301301, 1.334668001, 1.368034701, 1.401401401, 1.434768101, 1.468134801, 1.501501502, 1.534868202, 1.568234902, 1.601601602, 1.634968302, 1.668335002, 1.701701702, 1.735068402, 1.768435102, 1.801801802, 1.835168502, 1.868535202, 1.901901902, 1.935268602, 1.968635302, 2.002002002, 2.035368702, 2.068735402, 2.102102102, 2.135468802, 2.168835502, 2.202202202, 2.235568902, 2.268935602, 2.302302302, 2.335669002, 2.369035702, 2.402402402, 2.435769102, 2.469135802, 2.502502503, 2.535869203, 2.569235903, 2.602602603];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.067422055, 0.06937218, 0.070986717, 0.072857895, 0.074593985, 0.076061654, 0.077467669, 0.078709524, 0.080642356, 0.082050877, 0.083876942, 0.085281203, 0.086772431, 0.088204261, 0.090231328, 0.090917043, 0.093004511, 0.094673935, 0.096345363, 0.097896241, 0.099199749, 0.100930827, 0.102874185, 0.103851629, 0.105598246, 0.107386216, 0.109211779, 0.110680451, 0.112277694, 0.113762406, 0.114921053, 0.116692732, 0.118241855, 0.119936842, 0.121841103, 0.123190476, 0.124784211, 0.126014536, 0.127557393, 0.129705764, 0.130798246, 0.132584962, 0.133988972, 0.135774436, 0.13723584, 0.138774436, 0.140332581, 0.141808521, 0.143123559, 0.144543108, 0.146233333, 0.147672682, 0.149489223, 0.150890226, 0.152418296, 0.153972431, 0.155612782, 0.156980702, 0.158586216, 0.16005188, 0.161694236, 0.163367419, 0.16432782, 0.166271429, 0.167351378, 0.168943609, 0.170214536, 0.171724311, 0.173437343, 0.174889975, 0.176134837, 0.177942356, 0.179135589, 0.18099198, 0.182215288, 0.182997243, 0.184499499, 0.185184461, 0.185319048];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101, 1.134467801, 1.167834501, 1.201201201, 1.234567901, 1.267934601, 1.301301301, 1.334668001, 1.368034701, 1.401401401, 1.434768101, 1.468134801, 1.501501502, 1.534868202, 1.568234902, 1.601601602, 1.634968302, 1.668335002, 1.701701702, 1.735068402, 1.768435102, 1.801801802, 1.835168502, 1.868535202, 1.901901902, 1.935268602, 1.968635302, 2.002002002, 2.035368702, 2.068735402, 2.102102102, 2.135468802, 2.168835502, 2.202202202, 2.235568902, 2.268935602, 2.302302302, 2.335669002, 2.369035702, 2.402402402, 2.435769102, 2.469135802, 2.502502503, 2.535869203, 2.569235903, 2.602602603, 2.635969303];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.07509202, 0.076721446, 0.078485037, 0.0805399, 0.081858354, 0.083190773, 0.084770075, 0.086480299, 0.088331172, 0.089786534, 0.091207731, 0.093011721, 0.0945202, 0.09584813, 0.097091771, 0.098656359, 0.100462344, 0.101954115, 0.103370823, 0.105426933, 0.106925686, 0.108812968, 0.110472818, 0.111851372, 0.113341646, 0.114914963, 0.1166798, 0.118245636, 0.119928928, 0.121421696, 0.123000249, 0.124573067, 0.126250873, 0.128356359, 0.129837157, 0.131049875, 0.132514713, 0.134323441, 0.135766334, 0.137581546, 0.139405486, 0.141229426, 0.142507232, 0.144053865, 0.145553616, 0.147225436, 0.148713965, 0.150564838, 0.15189202, 0.153726933, 0.154976559, 0.156694015, 0.158113965, 0.159963342, 0.161519701, 0.162898254, 0.164663092, 0.166435411, 0.167863342, 0.169299252, 0.170822943, 0.1727399, 0.174019701, 0.17514788, 0.176496259, 0.178183292, 0.179125686, 0.180361097, 0.181468579];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101, 1.134467801, 1.167834501, 1.201201201, 1.234567901, 1.267934601, 1.301301301, 1.334668001, 1.368034701, 1.401401401, 1.434768101, 1.468134801, 1.501501502, 1.534868202, 1.568234902, 1.601601602, 1.634968302, 1.668335002, 1.701701702, 1.735068402, 1.768435102, 1.801801802, 1.835168502, 1.868535202, 1.901901902, 1.935268602, 1.968635302, 2.002002002, 2.035368702, 2.068735402, 2.102102102, 2.135468802, 2.168835502, 2.202202202, 2.235568902, 2.268935602, 2.302302302];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

average_vel_4mm = mean([Average_vel1,Average_vel2,Average_vel3,Average_vel4,Average_vel5]);
d = 4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_4mm = average_vel_4mm / cor_factor
log_v = log([Average_vel1,Average_vel2,Average_vel3,Average_vel4,Average_vel5]);
variance1 = var(log_v)
%%
%钢球在甘油中的平均速度6mm 
dis = [0.100639211, 0.103490719, 0.106334339, 0.110159629, 0.112995592, 0.115814617, 0.118744548, 0.121638747, 0.125173086, 0.127736427, 0.130706497, 0.133485615, 0.136339443, 0.139390487, 0.142917633, 0.145826914, 0.148333411, 0.151069374, 0.154289095, 0.156832251, 0.159851972, 0.162176334, 0.165135267, 0.168031555, 0.17082529, 0.173893039, 0.177214617, 0.179700928, 0.182577262, 0.18537355, 0.187564965, 0.18855406];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis=[0.09241224, 0.095321478, 0.098506928, 0.101356813, 0.10430485, 0.106892379, 0.109725866, 0.112845035, 0.1158903, 0.118777367, 0.121459353, 0.124256582, 0.127107621, 0.12996097, 0.132694226, 0.135681524, 0.138380139, 0.141294688, 0.144030023, 0.146758199, 0.149645266, 0.152881293, 0.155367436, 0.158177367, 0.160975982, 0.163743649, 0.166349885, 0.169767436, 0.172216628, 0.174723326, 0.177439261];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.082598165, 0.085391514, 0.088227294, 0.091023165, 0.093838073, 0.096943349, 0.099425, 0.10247867, 0.105297936, 0.108306422, 0.111295642, 0.113595413, 0.117026147, 0.119925917, 0.122586468, 0.124736468, 0.128055505, 0.130469954, 0.133473624, 0.137040826, 0.139261468, 0.141725229, 0.14495711, 0.147229817, 0.150777294, 0.153701376, 0.156042202, 0.158928899, 0.161711927, 0.164616284, 0.16756789, 0.170711239, 0.172788532];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701, 1.067734401, 1.101101101];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis = [0.082365376, 0.08514738, 0.087679499, 0.090682005, 0.094438497, 0.096547608, 0.099234852, 0.102121185, 0.105527563, 0.107934396, 0.111446697, 0.114005923, 0.116749431, 0.119755125, 0.123220046, 0.126244647, 0.128961503, 0.131754897, 0.134636902, 0.137655809, 0.140170843, 0.143193622, 0.14631754, 0.148992027, 0.151479043, 0.154517995, 0.157499772, 0.160414806, 0.163455125, 0.165903872, 0.16882164];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901, 0.934267601, 0.967634301, 1.001001001, 1.034367701];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis = [0.088565753, 0.091684475, 0.09545411, 0.09842968, 0.101209817, 0.104371005, 0.10769589, 0.110739498, 0.113767352, 0.116990183, 0.119926712, 0.123066438, 0.125919863, 0.129310731, 0.132284247, 0.135383562, 0.13850274, 0.141477169, 0.144479452, 0.147289726, 0.150406164, 0.153082648, 0.156021233, 0.158784703, 0.161775571, 0.164731279, 0.167293151];
time =[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301, 0.667334001, 0.700700701, 0.734067401, 0.767434101, 0.800800801, 0.834167501, 0.867534201, 0.900900901];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);
%因为偏差较大，舍去了第五组的数据
average_vel_6mm = mean([Average_vel1,Average_vel2,Average_vel3,Average_vel4])
d = 6;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_6mm = average_vel_6mm / cor_factor
log_v = log([Average_vel1,Average_vel2,Average_vel3,Average_vel4]);
variance2 = var(log_v)

%钢球在甘油中的平均速度8mm 
dis=[0.113186695, 0.117218455, 0.121409013, 0.126523176, 0.130326824, 0.134439056, 0.138386266, 0.142984764, 0.147063734, 0.151200215, 0.155527682, 0.159767382, 0.163121459, 0.167793991, 0.171780687, 0.175798927, 0.178732618, 0.179427468];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.129289339, 0.132179744, 0.136453731, 0.140400426, 0.144507249, 0.14902516, 0.153284222, 0.157823454, 0.161571429, 0.165581663, 0.169981023, 0.174626226, 0.177578465, 0.178835394];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.106369915, 0.110662288, 0.114344703, 0.118384746, 0.122665678, 0.126649364, 0.130259958, 0.134513347, 0.13826589, 0.142003178, 0.146058898, 0.149957203, 0.153879449, 0.15739661, 0.16134322, 0.16531822, 0.169123305, 0.173228178, 0.177261017];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901, 0.600600601, 0.633967301];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.105791649, 0.109832976, 0.114365739, 0.118503426, 0.123313276, 0.127522912, 0.131756959, 0.136005567, 0.140302141, 0.144176231, 0.148358887, 0.15249379, 0.15704197, 0.160907066, 0.164927837, 0.168991649, 0.171995503];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201, 0.567233901];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.110853053, 0.115442105, 0.120069053, 0.124836211, 0.128673684, 0.132495579, 0.136772, 0.141235368, 0.145033474, 0.149148842, 0.153109684, 0.157621263, 0.161313474, 0.165642947, 0.169656632, 0.171864211];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671, 0.4671338, 0.500500501, 0.533867201];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);
average_vel_8mm = mean([Average_vel1,Average_vel2,Average_vel3,Average_vel4,Average_vel5])
d = 8;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_8mm = average_vel_8mm / cor_factor
log_v = log([Average_vel1,Average_vel2,Average_vel3,Average_vel4,Average_vel5]);
variance3 = var(log_v)

%钢球在甘油中的平均速度11.4mm 
dis=[0.168554123, 0.171378013, 0.17567611, 0.180928541, 0.186734249, 0.191900423, 0.192511628];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst)

dis = [0.138181328, 0.143647718, 0.148544398, 0.153410166, 0.158325726, 0.16350249, 0.168653734, 0.173693983, 0.179308091, 0.183390249, 0.186358714];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst)

dis=[0.149385892, 0.154393361, 0.160014938, 0.164972407, 0.170070124, 0.175280083, 0.179910996];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst)

dis=[0.13049408, 0.135766385, 0.140768922, 0.146247992, 0.151245032, 0.156254757, 0.161189641, 0.166312685, 0.171963636, 0.176296829, 0.181484567, 0.186344609, 0.18783129];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004, 0.4337671];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst)

dis=[0.137296473, 0.142640249, 0.147455187, 0.153280913, 0.158314315, 0.163723444, 0.168837967, 0.173532988, 0.178557884, 0.18348112, 0.184790041];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst)

%因为偏差较大，舍去了第一组的数据
average_vel_11mm = mean([Average_vel2,Average_vel3,Average_vel4,Average_vel5])
d = 11.4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3
cor_average_vel_11mm = average_vel_11mm / cor_factor
log_v = log([Average_vel2,Average_vel3,Average_vel4,Average_vel5]);
variance4 = var(log_v)

v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
variance = [variance1 variance2 variance3 variance4];
v_lst = log(v_lst);
r_lst = log(r_lst);
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('钢珠在甘油中')
text(0.63,-1.2,'R-squared: 0.999')
mdl = fitlm(r_lst,v_lst)


%%

v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1260;
eta = 0.934;
Re = rho*d_lst.*v_lst/eta






%%
%铝球在水中的平均速度4mm 
dis=[0.055994249, 0.070753355, 0.086752716, 0.102897764, 0.118440256, 0.132752716, 0.147856869, 0.162855591, 0.177814058, 0.193051118];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.0453, 0.059901274, 0.074092357, 0.087316561, 0.101307643, 0.113811465, 0.127159873, 0.141000637, 0.155592357, 0.168756688, 0.182593631];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.052037805, 0.066166463, 0.079243902, 0.092792073, 0.106548171, 0.119637805, 0.133173171, 0.14722439, 0.1603, 0.17372439];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.019064039, 0.036133498, 0.053280788, 0.070649261, 0.087447291, 0.104661576, 0.122016749, 0.13968867, 0.156642857];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.026618563, 0.041073054, 0.057349102, 0.073712575, 0.090631737, 0.107667066, 0.12441018, 0.140808383, 0.157634731, 0.174216766];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，4，5组数据更为合理
average_vel_4mm = mean([Average_vel1,Average_vel4,Average_vel5]);
d = 4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_4mm = average_vel_4mm / cor_factor

log_v = log([Average_vel1,Average_vel4,Average_vel5]);
variance1 = var(log_v)

%铝球在水中的平均速度6mm 
dis=[0.015229412, 0.033960784, 0.051603268, 0.06902549, 0.086852288, 0.104929412, 0.122558824, 0.139290196, 0.15715098, 0.175454248];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.018089542, 0.039333987, 0.052821569, 0.069845098, 0.086297386, 0.100830065, 0.117042484, 0.134182353, 0.151154248, 0.166248366, 0.182377778, 0.199215686];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.02608932, 0.043824595, 0.060666019, 0.077535922, 0.092324919, 0.108059547, 0.124563107, 0.141078317, 0.157664725, 0.174374757];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.013967925, 0.032167296, 0.046915723, 0.061483019, 0.077440252, 0.094274843, 0.110525786, 0.127525157, 0.143771698, 0.160537736, 0.178278616];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.094267093, 0.112026837, 0.1302, 0.148990415, 0.168061342, 0.186465176];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，3，5组数据更为合理
average_vel_6mm = mean([Average_vel1,Average_vel3,Average_vel5]);
d = 6;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_6mm = average_vel_6mm / cor_factor
log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance2 = var(log_v)

%铝球在水中的平均速度8mm 
dis=[0.024761783, 0.047459873, 0.066128025, 0.084278981, 0.102881529, 0.122221019, 0.142517197, 0.163538854, 0.185873885];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.009008946, 0.028619169, 0.05035655, 0.067894569, 0.086083067, 0.102888818, 0.120944409, 0.14013738, 0.158423642, 0.177028754, 0.197261342];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.027471845, 0.050376699, 0.073093851, 0.091469903, 0.108933333, 0.125954045, 0.145107443, 0.164631068, 0.184199353, 0.204238835];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.039011803, 0.05779541, 0.08025377, 0.100438689, 0.12040459, 0.140401967, 0.161045902, 0.183297705, 0.201859016, 0.039011803];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.0333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.00735, 0.026998667, 0.050004667, 0.071252, 0.090352667, 0.109336, 0.128404, 0.148176, 0.168505333, 0.190664, 0.205456667];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，4，5组数据更为合理
average_vel_8mm = mean([Average_vel1,Average_vel4,Average_vel5]);
d = 8;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_8mm = average_vel_8mm / cor_factor
log_v = log([Average_vel1,Average_vel4,Average_vel5]);
variance3 = var(log_v)

%铝球在水中的平均速度11.4mm 
dis=[0.014398113, 0.039971069, 0.064655975, 0.08950566, 0.109569182, 0.126069811, 0.144769811, 0.164830818, 0.185693082, 0.208039623];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.039326984, 0.063131429, 0.085598095, 0.102497778, 0.118745397, 0.137980317, 0.159470476, 0.18088254, 0.20255746];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.039171698, 0.061930818, 0.081962264, 0.103568553, 0.125738365, 0.148827044, 0.17082327, 0.192106918, 0.212984906];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.039171698, 0.061930818, 0.081962264, 0.103568553, 0.125738365, 0.148827044, 0.17082327, 0.192106918, 0.212984906];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.023896573, 0.046467913, 0.067042368, 0.087597508, 0.10856324, 0.13034081, 0.152540187, 0.174689097, 0.19618567, 0.207045483];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);
%使用第1，3，4组数据更为合理
average_vel_11mm = mean([Average_vel1,Average_vel3,Average_vel4]);
d = 11.4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_11mm = average_vel_11mm / cor_factor


log_v = log([Average_vel1,Average_vel3,Average_vel4]);
variance4 = var(log_v);
v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
variance = [variance1 variance2 variance3 variance4];
v_lst = log(v_lst);
r_lst = log(r_lst);
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('铝珠在水中')
text(0.63,0.5,'R-squared: 0.971')
mdl = fitlm(r_lst,v_lst)

%%



v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1000;
eta = 0.001;
Re = rho*d_lst.*v_lst/eta





%%
%钢球在水中的平均速度4mm 
dis=[0.020129518, 0.038783133, 0.060639157, 0.092123494, 0.12423494, 0.158624699, 0.193098795];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.020628313, 0.039468675, 0.067198193, 0.095363855, 0.127262048, 0.161264458, 0.194384337];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.018067267, 0.035652252, 0.060363363, 0.089225826, 0.12092973, 0.154870871, 0.191132132];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.23356692];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.020628313, 0.039468675, 0.067198193, 0.095363855, 0.127262048, 0.161264458, 0.194384337];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.033416822, 0.057, 0.083738318, 0.115249221, 0.148826791, 0.184132087, 0.219488474];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);


%使用第1，3，5组数据更为合理
average_vel_4mm = mean([Average_vel1,Average_vel3,Average_vel5]);
d = 4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_4mm = average_vel_4mm / cor_factor

log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance1 = var(log_v);

%钢珠在水中的平均速度6mm 
dis=[0.035752025, 0.058246106, 0.08830405, 0.121328972, 0.156891589, 0.194852336];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.024924845, 0.044570807, 0.071975776, 0.102148447, 0.137803106, 0.175613665, 0.215267702];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.031738509, 0.054793168, 0.084514907, 0.116713043, 0.153481366, 0.190551553, 0.22625528];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.034078882, 0.054910559, 0.085803106, 0.119467702, 0.155373913, 0.193393168, 0.229190683];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.021733951, 0.037637037, 0.065327778, 0.095039506, 0.128367284, 0.164969136, 0.20234321];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

dis=[0.029459375, 0.05133875, 0.08068875, 0.11300375, 0.149890625, 0.18925625, 0.227585625];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel6 = mean(v_lst);

%使用第3，4，5，6组数据更为合理
average_vel_6mm = mean([Average_vel3,Average_vel4,Average_vel5,Average_vel6]);
d = 6;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_6mm = average_vel_6mm / cor_factor


log_v = log([Average_vel3,Average_vel4,Average_vel5,Average_vel6]);
variance2 = var(log_v);

%钢珠在水中的平均速度8mm 
dis=[0.035403704, 0.062330247, 0.095098148, 0.13187284, 0.172593827, 0.215240123];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.047862154, 0.079705846, 0.115190769, 0.153745846, 0.194971077];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.056807385, 0.090056, 0.128130462, 0.168988923, 0.211851077];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.032952469, 0.05835, 0.090332099, 0.127101852, 0.166347531, 0.208296296];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.021788344, 0.042141718, 0.07178773, 0.105437423, 0.142927607, 0.182967485, 0.224010429];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);


%使用第1，2，3组数据更为合理
average_vel_8mm = mean([Average_vel1,Average_vel2,Average_vel3]);
d = 8;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_8mm = average_vel_8mm / cor_factor

log_v = log([Average_vel1,Average_vel2,Average_vel3]);
variance3 = var(log_v);


%钢珠在水中的平均速度11.4mm 
dis=[0.025265689, 0.051971261, 0.088628152, 0.125812903, 0.167162463, 0.212127273];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.017302655, 0.039658997, 0.071974631, 0.109338053, 0.148825959, 0.192456637, 0.236063127];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.043368452, 0.076602381, 0.115308929, 0.157393452, 0.203909524, 0.24335];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.027469231, 0.048795266, 0.083066272, 0.122250296, 0.164443787, 0.209375148];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.044316914, 0.077305638, 0.114681899, 0.154433234, 0.198924629, 0.235557864];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，3，5组数据更为合理
average_vel_11mm = mean([Average_vel1,Average_vel3,Average_vel5]);
d = 11.4;
D = 29;
cor_factor = 1-2.10*(d/D)+2.09*(d/D)^3;
cor_average_vel_11mm = average_vel_11mm / cor_factor
log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance4 = var(log_v);

v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
variance = [variance1 variance2 variance3 variance4];
v_lst = log(v_lst);
r_lst = log(r_lst);
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('钢珠在水中')
text(0.63,1.2,'R-squared: 0.977')
mdl = fitlm(r_lst,v_lst)


%%

v_lst = [cor_average_vel_4mm,cor_average_vel_6mm,cor_average_vel_8mm,cor_average_vel_11mm];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1000;
eta = 0.001;
Re = rho*d_lst.*v_lst/eta



















%%
%铝球在水中的平均速度4mm (没哟速度修正)
dis=[0.055994249, 0.070753355, 0.086752716, 0.102897764, 0.118440256, 0.132752716, 0.147856869, 0.162855591, 0.177814058, 0.193051118];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.0453, 0.059901274, 0.074092357, 0.087316561, 0.101307643, 0.113811465, 0.127159873, 0.141000637, 0.155592357, 0.168756688, 0.182593631];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.052037805, 0.066166463, 0.079243902, 0.092792073, 0.106548171, 0.119637805, 0.133173171, 0.14722439, 0.1603, 0.17372439];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.019064039, 0.036133498, 0.053280788, 0.070649261, 0.087447291, 0.104661576, 0.122016749, 0.13968867, 0.156642857];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.026618563, 0.041073054, 0.057349102, 0.073712575, 0.090631737, 0.107667066, 0.12441018, 0.140808383, 0.157634731, 0.174216766];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，4，5组数据更为合理
average_vel_4mm = mean([Average_vel1,Average_vel4,Average_vel5]);
d = 4;
D = 29;


log_v = log([Average_vel1,Average_vel4,Average_vel5]);
variance1 = var(log_v)
%%
%铝球在水中的平均速度6mm 
dis=[0.015229412, 0.033960784, 0.051603268, 0.06902549, 0.086852288, 0.104929412, 0.122558824, 0.139290196, 0.15715098, 0.175454248];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.018089542, 0.039333987, 0.052821569, 0.069845098, 0.086297386, 0.100830065, 0.117042484, 0.134182353, 0.151154248, 0.166248366, 0.182377778, 0.199215686];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337, 0.4004004];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.02608932, 0.043824595, 0.060666019, 0.077535922, 0.092324919, 0.108059547, 0.124563107, 0.141078317, 0.157664725, 0.174374757];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.013967925, 0.032167296, 0.046915723, 0.061483019, 0.077440252, 0.094274843, 0.110525786, 0.127525157, 0.143771698, 0.160537736, 0.178278616];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.094267093, 0.112026837, 0.1302, 0.148990415, 0.168061342, 0.186465176];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，3，5组数据更为合理
average_vel_6mm = mean([Average_vel1,Average_vel3,Average_vel5]);
d = 6;
D = 29;

log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance2 = var(log_v)
%%
%铝球在水中的平均速度8mm 
dis=[0.024761783, 0.047459873, 0.066128025, 0.084278981, 0.102881529, 0.122221019, 0.142517197, 0.163538854, 0.185873885];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.009008946, 0.028619169, 0.05035655, 0.067894569, 0.086083067, 0.102888818, 0.120944409, 0.14013738, 0.158423642, 0.177028754, 0.197261342];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.027471845, 0.050376699, 0.073093851, 0.091469903, 0.108933333, 0.125954045, 0.145107443, 0.164631068, 0.184199353, 0.204238835];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.039011803, 0.05779541, 0.08025377, 0.100438689, 0.12040459, 0.140401967, 0.161045902, 0.183297705, 0.201859016, 0.039011803];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.0333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.00735, 0.026998667, 0.050004667, 0.071252, 0.090352667, 0.109336, 0.128404, 0.148176, 0.168505333, 0.190664, 0.205456667];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667, 0.3670337];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，4，5组数据更为合理
average_vel_8mm = mean([Average_vel1,Average_vel4,Average_vel5]);
d = 8;
D = 29;

log_v = log([Average_vel1,Average_vel4,Average_vel5]);
variance3 = var(log_v)
%%
%铝球在水中的平均速度11.4mm 
dis=[0.014398113, 0.039971069, 0.064655975, 0.08950566, 0.109569182, 0.126069811, 0.144769811, 0.164830818, 0.185693082, 0.208039623];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.039326984, 0.063131429, 0.085598095, 0.102497778, 0.118745397, 0.137980317, 0.159470476, 0.18088254, 0.20255746];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.039171698, 0.061930818, 0.081962264, 0.103568553, 0.125738365, 0.148827044, 0.17082327, 0.192106918, 0.212984906];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.039171698, 0.061930818, 0.081962264, 0.103568553, 0.125738365, 0.148827044, 0.17082327, 0.192106918, 0.212984906];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.023896573, 0.046467913, 0.067042368, 0.087597508, 0.10856324, 0.13034081, 0.152540187, 0.174689097, 0.19618567, 0.207045483];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669, 0.2669336, 0.3003003, 0.333667];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);
%使用第1，3，4组数据更为合理
average_vel_11mm = mean([Average_vel1,Average_vel3,Average_vel4]);

%%
log_v = log([Average_vel1,Average_vel3,Average_vel4]);
variance4 = var(log_v);
v_lst = [average_vel_4mm,average_vel_6mm,average_vel_8mm,average_vel_11mm];
r_lst = [2,3,4,5.7];
variance = [variance1 variance2 variance3 variance4];
v_lst = log(v_lst);
r_lst = log(r_lst);
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('铝珠在水中')
text(0.63,-0.45,'R-squared: 0.97')
mdl = fitlm(r_lst,v_lst)

%%



v_lst = [average_vel_4mm,average_vel_6mm,average_vel_8mm,average_vel_11mm];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1000;
eta = 0.001;
Re = rho*d_lst.*v_lst/eta



%%
%钢球在水中的平均速度4mm 
dis=[0.020129518, 0.038783133, 0.060639157, 0.092123494, 0.12423494, 0.158624699, 0.193098795];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.020628313, 0.039468675, 0.067198193, 0.095363855, 0.127262048, 0.161264458, 0.194384337];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.018067267, 0.035652252, 0.060363363, 0.089225826, 0.12092973, 0.154870871, 0.191132132];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.23356692];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);

dis=[0.020628313, 0.039468675, 0.067198193, 0.095363855, 0.127262048, 0.161264458, 0.194384337];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.033416822, 0.057, 0.083738318, 0.115249221, 0.148826791, 0.184132087, 0.219488474];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);


%使用第1，3，5组数据更为合理
average_vel_4mm = mean([Average_vel1,Average_vel3,Average_vel5]);

log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance1 = var(log_v);
%%
%钢珠在水中的平均速度6mm 
dis=[0.035752025, 0.058246106, 0.08830405, 0.121328972, 0.156891589, 0.194852336];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.024924845, 0.044570807, 0.071975776, 0.102148447, 0.137803106, 0.175613665, 0.215267702];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.031738509, 0.054793168, 0.084514907, 0.116713043, 0.153481366, 0.190551553, 0.22625528];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.034078882, 0.054910559, 0.085803106, 0.119467702, 0.155373913, 0.193393168, 0.229190683];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.021733951, 0.037637037, 0.065327778, 0.095039506, 0.128367284, 0.164969136, 0.20234321];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

dis=[0.029459375, 0.05133875, 0.08068875, 0.11300375, 0.149890625, 0.18925625, 0.227585625];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel6 = mean(v_lst);

%使用第3，4，5，6组数据更为合理
average_vel_6mm = mean([Average_vel3,Average_vel4,Average_vel5,Average_vel6]);

log_v = log([Average_vel3,Average_vel4,Average_vel5,Average_vel6]);
variance2 = var(log_v);
%%
%钢珠在水中的平均速度8mm 
dis=[0.035403704, 0.062330247, 0.095098148, 0.13187284, 0.172593827, 0.215240123];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.047862154, 0.079705846, 0.115190769, 0.153745846, 0.194971077];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.056807385, 0.090056, 0.128130462, 0.168988923, 0.211851077];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.032952469, 0.05835, 0.090332099, 0.127101852, 0.166347531, 0.208296296];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.021788344, 0.042141718, 0.07178773, 0.105437423, 0.142927607, 0.182967485, 0.224010429];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);


%使用第1，2，3组数据更为合理
average_vel_8mm = mean([Average_vel1,Average_vel2,Average_vel3]);

log_v = log([Average_vel1,Average_vel2,Average_vel3]);
variance3 = var(log_v);
%%

%钢珠在水中的平均速度11.4mm 
dis=[0.025265689, 0.051971261, 0.088628152, 0.125812903, 0.167162463, 0.212127273];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_dis = diff(dis);
delta_time = diff(time);
v_lst = delta_dis ./ delta_time;
length(v_lst);
Average_vel1 = mean(v_lst);

dis = [0.017302655, 0.039658997, 0.071974631, 0.109338053, 0.148825959, 0.192456637, 0.236063127];
time = [0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002, 0.2335669];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel2 = mean(v_lst);

dis=[0.043368452, 0.076602381, 0.115308929, 0.157393452, 0.203909524, 0.24335];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel3 = mean(v_lst);


dis=[0.027469231, 0.048795266, 0.083066272, 0.122250296, 0.164443787, 0.209375148];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel4 = mean(v_lst);

dis=[0.044316914, 0.077305638, 0.114681899, 0.154433234, 0.198924629, 0.235557864];
time=[0.0333667, 0.0667334, 0.1001001, 0.1334668, 0.1668335, 0.2002002];
delta_time = diff(time);
delta_dis = diff(dis);
v_lst = delta_dis ./ delta_time;
Average_vel5 = mean(v_lst);

%使用第1，3，5组数据更为合理
average_vel_11mm = mean([Average_vel1,Average_vel3,Average_vel5]);


log_v = log([Average_vel1,Average_vel3,Average_vel5]);
variance4 = var(log_v);
%%
v_lst = [average_vel_4mm,average_vel_6mm,average_vel_8mm,average_vel_11mm];
r_lst = [2,3,4,5.7];
variance = [variance1 variance2 variance3 variance4];
v_lst = log(v_lst);
r_lst = log(r_lst);
errorbar(r_lst,v_lst,variance,'x');
xlabel('log（r）'),ylabel('log(v)');
title('钢珠在水中')
text(0.63,0.07,'R-squared: 0.937')
mdl = fitlm(r_lst,v_lst)


%%

v_lst = [average_vel_4mm,average_vel_6mm,average_vel_8mm,average_vel_11mm];
r_lst = [2,3,4,5.7];
d_lst=r_lst*2/1000;
rho = 1000;
eta = 0.001;
Re = rho*d_lst.*v_lst/eta














